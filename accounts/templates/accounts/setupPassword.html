{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Setup Password</title>
        <link href="{% static 'vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet" type="text/css">
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700%7cPoppins:300,400,500,600,700,800,900&amp;display=swap" rel="stylesheet" />
        <link href="{% static 'vendors/simplebar/simplebar.min.css' %}" rel="stylesheet" />
        <link href="{% static 'assets/css/theme-rtl.css' %}" rel="stylesheet" id="style-rtl" />
        <link href="{% static 'assets/css/theme.css' %}" rel="stylesheet" id="style-default" />
        <link href="{% static 'assets/css/user-rtl.css' %}" rel="stylesheet" id="user-style-rtl" />
        <link href="{% static 'assets/css/user.css' %}" rel="stylesheet" id="user-style-default" />
        <link rel="icon" type="image/png" href="{% static 'favicon.ico' %}" />
    </head>
    <body class="bg-login">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-6 col-lg-8 col-md-10">
                    <div class="card o-hidden border-0 shadow-lg my-5">
                        <div class="card-body p-5">
                            <div class="text-center">
                                <h1 class="h4 text-gray-900 mb-4">Setup Your Password</h1>
                            </div>
                            <form method="POST" action="">
                                {% csrf_token %}
                                {{ form.email.label_tag }}
                                {{ form.email }}
                                <br>
                                {{ form.identification.label_tag }}
                                {{ form.identification }}
                                <br>
                                <hr>
                                {% if show_password_fields %}
                                    {{ form.password.label_tag }}
                                    {{ form.password }}
                                    <br>
                                    {{ form.confirm_password.label_tag }}
                                    {{ form.confirm_password }}
                                    <br>
                                    <button type="submit" class="btn btn-primary btn-user btn-block">Set Password</button>
                                {% else %}
                                    <button type="submit" class="btn btn-primary btn-user btn-block">Verify</button>
                                {% endif %}
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
        <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- Core plugin JavaScript -->
        <script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}"></script>
    <!-- Custom scripts for all pages -->
        <script src="{% static 'js/sb-admin-2.min.js' %}"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    </body>


    <script>
        function displayToast(message, icon) {
            Swal.fire({
                toast: true,
                position: 'top-end',
                icon: icon,
                title: message,
                showConfirmButton: false,
                timer: 5000,
                timerProgressBar: true,
            });
        }

    // Check for form errors and display them with error icon
        {% if form.errors %}
            {% for field in form %}
                {% for error in field.errors %}
                    displayToast("{{ error }}", 'error');  // Display form errors with 'error' icon
                {% endfor %}
            {% endfor %}
        {% endif %}

    // Check for Django messages and handle their type
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'error' %}
                    displayToast("{{ message }}", 'error');  // Display error messages
                {% else %}
                    displayToast("{{ message }}", 'success');  // Display success or other messages
                {% endif %}
            {% endfor %}
        {% endif %}
    </script>
</html>
